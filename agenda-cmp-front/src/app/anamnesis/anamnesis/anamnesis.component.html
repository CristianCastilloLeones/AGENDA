<div class="main-cont">
  <!-- <div fxLayout="row">
    <mat-icon class="little-down">add</mat-icon>
    <h1 class="mat-h1">Consulta</h1>
  </div> -->

  <!--  <mat-tab-group mat-align-tabs="start" >
    <mat-tab >
      <ng-template mat-tab-label>
        <span class="header-title">Paciente: </span>
        <span class="header-fix-content">{{patient.name}} {{patient.surname}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Edad: </span>
        <span class="header-fix-content">{{age}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Sexo: </span>
        <span class="header-fix-content">{{this.patient.sexo}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">HCL: </span>
        <span class="header-fix-content">{{patient.dni}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Peso: </span>
        <span class="header-fix-content">{{anamnesisForm.get('peso').value}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Talla: </span>
        <span class="header-fix-content">{{anamnesisForm.get('talla').value}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Glucemia: </span>
        <span class="header-fix-content">{{anamnesisForm.get('glucemia').value}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Temp: </span>
        <span class="header-fix-content">{{anamnesisForm.get('temp_bucal').value}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">IMC: </span>
        <span class="header-fix-content">{{anamnesisForm.get('imc').value}}</span>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="header-title">Enfermedad Actual: </span>
        <span class="header-fix-content">{{anamnesisForm.get('enf_problema_actual').value}}</span>
      </ng-template>
    </mat-tab>
  </mat-tab-group> -->

  <mat-card class="example-card">
    <mat-card-content fxLayout="row wrap" fxLayout.xs="column" fxLayoutGap="3px">

      <div fxFlex="28%">
        <span class="header-title">Paciente: </span>
        <span class="header-fix-content">{{patient.name}} {{patient.surname}}</span>
      </div>
      <div fxFlex="30%">
        <span class="header-title">Edad: </span>
        <span class="header-fix-content">{{age}}</span>
      </div>
      <div fxFlex="10%">
        <span class="header-title">Sexo: </span>
        <span class="header-fix-content">{{this.patient.sexo}}</span>
      </div>
      <div fxFlex="10%">
        <span class="header-title">Talla: </span>
        <span class="header-fix-content">{{anamnesisForm.get('talla').value}}</span>
      </div>
      <div fxFlex="20%">
        <span class="header-title">Peso: </span>
        <span class="header-fix-content">{{anamnesisForm.get('peso').value}}</span>
      </div>
      <br>
      <div fxFlex="28%">
        <span class="header-title">HCL: </span>
        <span class="header-fix-content">{{patient.dni}}</span>
      </div>

      <div fxFlex="30%">
        <span class="header-title">Enfermedad Actual: </span>
        <span class="header-fix-content">{{anamnesisForm.get('enf_problema_actual').value}}</span>
      </div>

      <div fxFlex="10%">
        <span class="header-title">Temp: </span>
        <span class="header-fix-content">{{anamnesisForm.get('temp_bucal').value}}</span>
      </div>
      <div fxFlex="10%">
        <span class="header-title">IMC: </span>
        <span class="header-fix-content">{{anamnesisForm.get('imc').value}}</span>
      </div>
      <div fxFlex="15%">
        <span class="header-title">Glucemia: </span>
        <span class="header-fix-content">{{anamnesisForm.get('glucemia').value}}</span>
      </div>
    </mat-card-content>
    <mat-card-actions *ngIf="alergies.length>0">
      <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign="start center" style="font-size: 13px;">
      <span>Alergias:&nbsp;</span>
      <mat-chip-list>
        <mat-chip style="background:#FF6E40" *ngFor="let alergie of alergies">
          {{alergie | uppercase}}</mat-chip>
      </mat-chip-list>
    </div>

    </mat-card-actions>
  </mat-card>
  <!-- <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign="space-around" class="anamnesis-header" id="headerfix">

    <div>
      <span class="header-title">Paciente: </span>
      <span class="header-fix-content">{{patient.name}} {{patient.surname}}</span>
    </div>
    <div>
      <span class="header-title">Edad: </span>
      <span class="header-fix-content">{{age}}</span>
    </div>
    <div>
      <span class="header-title">Sexo: </span>
      <span class="header-fix-content">{{this.patient.sexo}}</span>
    </div>
    <div>
      <span class="header-title">HCL: </span>
      <span class="header-fix-content">{{patient.dni}}</span>
    </div>
    <div>
      <span class="header-title">Peso: </span>
      <span class="header-fix-content">{{anamnesisForm.get('peso').value}}</span>
    </div>
    <div>
      <span class="header-title">Talla: </span>
      <span class="header-fix-content">{{anamnesisForm.get('talla').value}}</span>
    </div>
    <div>
      <span class="header-title">Glucemia: </span>
      <span class="header-fix-content">{{anamnesisForm.get('glucemia').value}}</span>
    </div>
    <div>
      <span class="header-title">Temp: </span>
      <span class="header-fix-content">{{anamnesisForm.get('temp_bucal').value}}</span>
    </div>
    <div>
      <span class="header-title">IMC: </span>
      <span class="header-fix-content">{{anamnesisForm.get('imc').value}}</span>
    </div>
  </div>
  <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign="space-around" class="anamnesis-header" id="headerfix">

    <div>
      <span class="header-title">Enfermedad Actual: </span>
      <span class="header-fix-content">{{anamnesisForm.get('enf_problema_actual').value}}</span>
    </div>

  </div> -->

  <br>
  <mat-tab-group>

    <mat-tab>

      <ng-template mat-tab-label>
        <span class="tab-label">Ficha personal</span>
      </ng-template>
      <br>
      <mat-card class="example-card">
        <mat-card-content>
          <form [formGroup]="anamnesisForm">
            <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign="start center" fxLayoutGap="2%">
              <span fxFlex="100%" class="sub-title">Alergias</span>
              <mat-form-field class="example-chip-list" fxFlex="78%" appearance="outline">
                <mat-chip-list #chipList>
                  <mat-chip *ngFor="let alergie of alergies" [selectable]="selectable" [removable]="removable"
                    (removed)="remove(alergie)">
                    {{alergie}}
                    <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                  </mat-chip>
                  <input placeholder="Ingrese una nueva alergia..." [matChipInputFor]="chipList"
                    [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur"
                    (matChipInputTokenEnd)="add($event)">
                </mat-chip-list>
              </mat-form-field>
              <button fxFlex="20%" mat-flat-button style="background:#FF6E40;color: white;"
                (click)="saveAllergies()">Guardar
                alergias</button>
              <!-- <mat-form-field fxFlex="80%" appearance="fill">
                      <textarea matInput rows="1" placeholder="Descripción de alergias" formControlName="allergies"></textarea>
                    </mat-form-field>
                    <button fxFlex="20%" mat-flat-button color="accent" (click)="saveAllergies()">Guardar alergias</button> -->
            </div>


            <div fxLayout="row wrap" fxLayout.xs="column">
              <span fxFlex="100%" class="sub-title">Signos vitales</span>
              <div *ngFor="let sv of signos_vitales" fxLayout="row wrap" fxFlex="20%" fxLayoutGap="5px">
                <mat-form-field class="example-form-field" appearance="outline">
                  <mat-label>{{sv.name}}</mat-label>
                  <input matInput type="text" formControlName="{{sv.control}}" matTooltip="{{sv.tooltip}}"
                    matTooltipPosition="above" placeholder="{{sv.tooltip}}">
                </mat-form-field>
              </div>
              <label fxFlex="29%" style="font-size: 12px;" class="sub-title">ESCALA DE COMA DE GLASGOW</label>
              <div fxFlex="100%" fxLayoutGap="5px">
                <mat-form-field fxFlex="15%" appearance="outline">
                  <mat-label>M</mat-label>
                  <input matInput matTooltip="Respuesta Motora" matTooltipPosition="above"
                    placeholder="Respuesta Motora" formControlName="gcs_m">
                </mat-form-field>
                <mat-form-field fxFlex="15%" appearance="outline">
                  <mat-label>O</mat-label>
                  <input matInput matTooltip="Respuesta Ocular" matTooltipPosition="above"
                    placeholder="Respuesta Ocular" formControlName="gcs_o">
                </mat-form-field>
                <mat-form-field fxFlex="15%" appearance="outline">
                  <mat-label>V</mat-label>
                  <input matInput matTooltip="Respuesta Verbal" matTooltipPosition="above"
                    placeholder="Respuesta Verbal" formControlName="gcs_v">
                </mat-form-field>
                <mat-form-field fxFlex="50%" appearance="outline">
                  <mat-label>Observaciones</mat-label>
                  <input placeholder="Observaciones" matInput formControlName="signos_vitales">

                </mat-form-field>
              </div>

            </div>
            <!--<mat-tab *ngIf="role == '2' || role == '1'" label="Antecendetes Personales">-->
            <div *ngIf="role == '2' || role == '1'">
              <div fxLayout="row wrap" fxLayout.xs="column">
                <span fxFlex="100%" class="sub-title">Antecendetes personales</span>
                <mat-checkbox *ngFor="let ap of ant_personales" formControlName="{{ap.control}}" labelPosition="after"
                  fxFlex="14.28%" fxFlex.sm="20%" style="padding-left:15px; padding-right:15px; font-size:10px;">
                  {{ap.name}}
                </mat-checkbox>
                <mat-form-field fxFlex="100%" appearance="outline">
                  <mat-label>Observaciones</mat-label>
                  <input matInput placeholder="Observaciones" formControlName="antecedente_personales">

                </mat-form-field>
              </div>
              <!--</mat-tab>-->

              <!--<mat-tab *ngIf="role == '2' || role == '1'" label="Antecendetes Familiares">-->
              <div fxLayout="row wrap" fxLayout.xs="column">
                <span fxFlex="100%" class="sub-title">Antecedentes familiares</span>
              </div>

              <div fxLayout="row wrap" fxLayout.xs="column">


                <mat-checkbox *ngFor="let af of ant_familiares" formControlName="{{af.control}}" labelPosition="after"
                  fxFlex="10%" style="padding-left:15px; padding-right:15px; font-size:10px;">
                  {{af.name}}
                </mat-checkbox>



                <!--  <mat-form-field fxFlex="40%" appearance="fill">
                        <mat-label>Enfermedad o problema actual</mat-label>
                        <input matInput formControlName="enf_problema_actual" placeholder="Enfermedad o problema actual">

                      </mat-form-field> -->
              </div>
              <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutGap="5%">
                <mat-form-field fxFlex="40%" appearance="outline">
                  <mat-label>Observaciones</mat-label>
                  <input matInput placeholder="Observaciones" formControlName="antecedentes_familiares">

                </mat-form-field>
                <mat-form-field fxFlex="45%" appearance="outline">
                  <mat-label>Enfermedad o problema actual</mat-label>
                  <input matInput formControlName="enf_problema_actual" placeholder="Enfermedad o problema actual">

                </mat-form-field>
              </div>

              <!--</mat-tab>-->

              <!--<mat-tab label="Enfermedad o problema actual">-->



              <!--</mat-tab>-->

              <!--<mat-tab label="Revisión actual de Órganos y Sistemas" *ngIf="role == '2' || role == '1'">-->

              <div fxLayout="row wrap" fxLayout.xs="column">
                <span fxFlex="100%" class="sub-title">Revisión actual de organos y sistemas</span>
                <div *ngFor="let rva of revision_actual" fxLayout="row wrap" fxFlex="20%" fxLayoutGap="5px"
                  class="box-c">
                  <label style="font-size: 10px;" fxFlex="100%">{{rva.name}}</label>
                  <mat-checkbox formControlName="{{rva.cp}}" style="font-size: 10px;">CP</mat-checkbox>
                  <mat-checkbox formControlName="{{rva.sp}}" style="font-size: 10px;">SP</mat-checkbox>
                </div>
                <mat-form-field fxFlex="100%" appearance="outline">
                  <mat-label>Observaciones</mat-label>
                  <input placeholder="Observaciones" matInput formControlName="revision_org_sistemas">

                </mat-form-field>
              </div>

              <!--</mat-tab>-->

              <!--<mat-tab label="Signos Vitales">-->


              <!--</mat-tab>-->

              <!--<mat-tab label="Alergias">-->


              <!--</mat-tab>-->

              <!--<mat-tab label="Examen Físico." *ngIf="role == '2' || role == '1'">-->
              <div fxLayout="row wrap" fxLayout.xs="column">
                <span fxFlex="100%" class="sub-title">Examen fisico</span>
                <div *ngFor="let ef of examen_fisico" fxLayout="row wrap" fxFlex="20%" fxLayoutGap="5px" class="box-c">
                  <label style="font-size: 10px;" fxFlex="100%">{{ef.name}}</label>
                  <mat-checkbox formControlName="{{ef.cp}}" style="font-size: 10px;">CP</mat-checkbox>
                  <mat-checkbox formControlName="{{ef.sp}}" style="font-size: 10px;">SP</mat-checkbox>
                </div>
                <mat-form-field fxFlex="100%" appearance="outline">
                  <mat-label>Observaciones</mat-label>
                  <input placeholder="Observaciones" matInput formControlName="examen_fisico">

                </mat-form-field>
              </div>
              <div fxLayout="row wrap" fxLayout.xs="column">
                <label fxFlex="100%" class="sub-title">Motivo de la consulta.</label>
                <div fxLayout="row" fxFlex="100%" fxLayoutGap="5px">
                  <mat-form-field fxFlex="49%" appearance="outline">
                    <input  matInput placeholder="A" formControlName="motivo_a">
                  </mat-form-field>
                  <mat-form-field fxFlex="49%" appearance="outline">
                    <input  matInput placeholder="B" formControlName="motivo_b">
                  </mat-form-field>
                </div>
                <div fxLayout="row" fxFlex="100%" fxLayoutGap="5px">
                  <mat-form-field fxFlex="49%" appearance="outline">
                    <input  matInput placeholder="C" formControlName="motivo_c">
                  </mat-form-field>
                  <mat-form-field fxFlex="49%" appearance="outline">
                    <input  matInput placeholder="D" formControlName="motivo_d">
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div fxLayout="row" fxLayoutAlign="space-between start">
              <a routerLink="/citas" mat-flat-button color="accent">Menu Citas</a>
              <button mat-flat-button color="primary" (click)="saveHistory()">Guardar Ficha Personal</button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>


    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Historial</span>
      </ng-template>
      <app-history [dni]="patient"></app-history>
    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Laboratorio</span>
      </ng-template>
      <app-exlab [event]="patient"></app-exlab>

      <div class="related-labs mat-elevation-z8" *ngIf="relatedLabs.length > 0">
        <span style="font-weight: bold;">Examenes de laboratorio realizados en esta cita:</span>
        <div *ngFor="let rlab of relatedLabs" class="related-lab">
          {{rlab.name}} - {{rlab.unit_price | currency : $}}
        </div>
      </div>

    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Ecografias</span>
      </ng-template>
      <app-eco-create [patient]="patient"></app-eco-create>
      <div class="related-labs mat-elevation-z8" *ngIf="relatedEchoes.length > 0">
        <span style="font-weight: bold;">Ecografias realizadas en esta cita:</span>
        <div *ngFor="let eco of relatedEchoes" class="related-lab">
          {{eco.ecos}} - {{eco.price | currency}}
        </div>
      </div>
    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Papanicolaou</span>
      </ng-template>
      <app-papanicolaou-create #papanicolao [patient]="patient"></app-papanicolaou-create>
    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Receta</span>
      </ng-template>
      <app-diagnostico></app-diagnostico>
      <div>
        <button mat-flat-button color="primary" (click)="confirmSave()">Procesar</button>
      </div>
    </mat-tab>

    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Certificado</span>
      </ng-template>
      <app-certificado [patient]="patient"></app-certificado>
    </mat-tab>
    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Interconsulta</span>
      </ng-template>
      <app-derivation [event]="patient"></app-derivation>

      <!-- <div class="related-labs mat-elevation-z8" *ngIf="relatedLabs.length > 0">
            <span style="font-weight: bold;">Examenes de laboratorio realizados en esta cita:</span>
            <div *ngFor="let rlab of relatedLabs" class="related-lab">
              {{rlab.name}} - {{rlab.unit_price | currency : $}}
            </div>
          </div> -->

    </mat-tab>
    <mat-tab *ngIf="role == '2' || role == '1'">
      <ng-template mat-tab-label>
        <span class="tab-label">Dieta</span>
      </ng-template>
      <app-diet [patient]="patient"></app-diet>
    </mat-tab>

  </mat-tab-group>

</div>

<mat-spinner *ngIf="loading" style="position: fixed; bottom:10px; right:10px;" diameter="50"></mat-spinner>
